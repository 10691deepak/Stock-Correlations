p_value_matrix <- function(correlation_matrix,sample_size){
  
  #find number of columns and rows in correlation matrix
  num_cols <- ncol(correlation_matrix)
  num_rows <- nrow(correlation_matrix)
  
  #pre-allocate p-value matrix size for speed, and so col and row names are already there ;)
  p_value_matrix <- correlation_matrix
  
  #loop through rows and columns of correlation matrix finding the p-value and filling in the 
  #p-value matrix
  for(i in 1 : num_cols){
    for(j in 1 : num_cols){
      
      #element (i,j) of the correlation matrix (the element presently being considered to find p-value)
      temp_correlation <- correlation_matrix[i,j]
      
      #formula of t-value (ignoring the sign of the correlation) 
      #(sign doesnt matter when finding p-value from t-value))
      temp_t_value <- sqrt(abs(((temp_correlation^2)*(sample_size-2))/(1-(temp_correlation^2))))
      
      #finding p-value based on t-value                  
      temp_p_value <- 2*pt(-abs(temp_t_value),df=sample_size-2) 
      
      #assign p-value to element (i,j) of p_value_matrix
      p_value_matrix[i,j] <- temp_p_value 
    }
  }

  return(p_value_matrix)

}
  
